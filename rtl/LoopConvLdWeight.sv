// Generated by CIRCT firtool-1.61.0
// Standard header to adapt well known macros for register randomization.
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_MEM_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_MEM_INIT
`endif // not def RANDOMIZE
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_REG_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_REG_INIT
`endif // not def RANDOMIZE

// RANDOM may be set to an expression that produces a 32-bit random unsigned value.
`ifndef RANDOM
  `define RANDOM $random
`endif // not def RANDOM

// Users can define INIT_RANDOM as general code that gets injected into the
// initializer block for modules with registers.
`ifndef INIT_RANDOM
  `define INIT_RANDOM
`endif // not def INIT_RANDOM

// If using random initialization, you can also define RANDOMIZE_DELAY to
// customize the delay used, otherwise 0.002 is used.
`ifndef RANDOMIZE_DELAY
  `define RANDOMIZE_DELAY 0.002
`endif // not def RANDOMIZE_DELAY

// Define INIT_RANDOM_PROLOG_ for use in our modules below.
`ifndef INIT_RANDOM_PROLOG_
  `ifdef RANDOMIZE
    `ifdef VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM
    `else  // VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM #`RANDOMIZE_DELAY begin end
    `endif // VERILATOR
  `else  // RANDOMIZE
    `define INIT_RANDOM_PROLOG_
  `endif // RANDOMIZE
`endif // not def INIT_RANDOM_PROLOG_

// Include register initializers in init blocks unless synthesis is set
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_REG_
    `define ENABLE_INITIAL_REG_
  `endif // not def ENABLE_INITIAL_REG_
`endif // not def SYNTHESIS

// Include rmemory initializers in init blocks unless synthesis is set
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_MEM_
    `define ENABLE_INITIAL_MEM_
  `endif // not def ENABLE_INITIAL_MEM_
`endif // not def SYNTHESIS

// Standard header to adapt well known macros for prints and assertions.

// Users can define 'PRINTF_COND' to add an extra gate to prints.
`ifndef PRINTF_COND_
  `ifdef PRINTF_COND
    `define PRINTF_COND_ (`PRINTF_COND)
  `else  // PRINTF_COND
    `define PRINTF_COND_ 1
  `endif // PRINTF_COND
`endif // not def PRINTF_COND_

// Users can define 'ASSERT_VERBOSE_COND' to add an extra gate to assert error printing.
`ifndef ASSERT_VERBOSE_COND_
  `ifdef ASSERT_VERBOSE_COND
    `define ASSERT_VERBOSE_COND_ (`ASSERT_VERBOSE_COND)
  `else  // ASSERT_VERBOSE_COND
    `define ASSERT_VERBOSE_COND_ 1
  `endif // ASSERT_VERBOSE_COND
`endif // not def ASSERT_VERBOSE_COND_

// Users can define 'STOP_COND' to add an extra gate to stop conditions.
`ifndef STOP_COND_
  `ifdef STOP_COND
    `define STOP_COND_ (`STOP_COND)
  `else  // STOP_COND
    `define STOP_COND_ 1
  `endif // STOP_COND
`endif // not def STOP_COND_

module LoopConvLdWeight(
  input         clock,
                reset,
  output        io_req_ready,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  input         io_req_valid,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  input  [15:0] io_req_bits_outer_bounds_in_channels,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_outer_bounds_out_channels,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_outer_bounds_weight_stride,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_outer_bounds_kernel_dim,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_inner_bounds_krows,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_inner_bounds_kcols,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_inner_bounds_kchs,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_derived_params_ochs,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_derived_params_out_channels_per_bank,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_derived_params_in_channels_per_bank,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_derived_params_weight_spad_stride,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  input  [13:0] io_req_bits_addr_end,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  input  [33:0] io_req_bits_dram_addr,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  input         io_req_bits_trans_weight_1203,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_trans_weight_0132,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_dw,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_req_bits_loop_id,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_cmd_ready,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  output        io_cmd_valid,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  output [6:0]  io_cmd_bits_inst_funct,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  output [63:0] io_cmd_bits_rs1,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_cmd_bits_rs2,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  output        io_idle,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  input         io_rob_overloaded,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
                io_wait_for_prev_loop,	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
  output        io_loop_id	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:420:14]
);

  wire        _command_p_io_in_ready;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  wire        _command_p_io_out_valid;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  wire [6:0]  _command_p_io_out_bits_cmd_inst_funct;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  wire [63:0] _command_p_io_out_bits_cmd_rs1;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  wire [63:0] _command_p_io_out_bits_cmd_rs2;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  wire [67:0] _command_p_io_out_bits_dram_addr;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  wire [63:0] _command_p_io_out_bits_spad_addr;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  wire [15:0] _command_p_io_out_bits_K;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  wire [15:0] _command_p_io_out_bits_J;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  wire        _command_p_io_busy;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  reg  [1:0]  state;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22]
  reg  [15:0] req_outer_bounds_in_channels;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_outer_bounds_out_channels;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_outer_bounds_weight_stride;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_outer_bounds_kernel_dim;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_inner_bounds_krows;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_inner_bounds_kcols;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_inner_bounds_kchs;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_derived_params_ochs;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_derived_params_out_channels_per_bank;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_derived_params_in_channels_per_bank;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [15:0] req_derived_params_weight_spad_stride;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [13:0] req_addr_end;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg  [33:0] req_dram_addr;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg         req_trans_weight_1203;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg         req_trans_weight_0132;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg         req_dw;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  reg         req_loop_id;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
  wire [15:0] max_chs_per_mvin_max_ochs_per_mvin = req_derived_params_ochs < 16'h40 ? req_derived_params_ochs : 16'h40;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :444:{32,38}]
  wire [15:0] max_chs_per_mvin_max_kchs_per_mvin = req_inner_bounds_kchs < 16'h40 ? req_inner_bounds_kchs : 16'h40;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :444:32, :445:{32,38}]
  wire [15:0] max_chs_per_mvin = req_trans_weight_0132 ? max_chs_per_mvin_max_kchs_per_mvin : max_chs_per_mvin_max_ochs_per_mvin;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :444:32, :445:32, :446:8]
  wire [31:0] _GEN = {16'h0, req_inner_bounds_kcols};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :449:64, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [47:0] _GEN_0 = {32'h0, req_inner_bounds_krows};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :449:72]
  wire [63:0] _GEN_1 = {48'h0, req_derived_params_ochs};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :449:80]
  wire [63:0] _GEN_2 = {48'h0, req_inner_bounds_kchs};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :449:80, :450:43]
  wire [63:0] _addr_start_T = {50'h0, req_addr_end} - (req_trans_weight_0132 ? {16'h0, {16'h0, {16'h0, req_derived_params_in_channels_per_bank} * _GEN} * _GEN_0} * _GEN_1 : {16'h0, {16'h0, {16'h0, req_derived_params_out_channels_per_bank} * _GEN} * _GEN_0} * _GEN_2);	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :449:{19,64,72,80}, :450:{27,35,43}, :451:33, :466:87, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [31:0] _GEN_3 = {16'h0, req_outer_bounds_kernel_dim};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :455:42, src/main/scala/chisel3/util/Mux.scala:141:16]
  reg  [15:0] och;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:460:16]
  reg  [15:0] krow;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:461:17]
  reg  [15:0] kcol;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:462:17]
  reg  [15:0] kch;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:463:16]
  wire [31:0] _GEN_4 = {16'h0, krow};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:461:17, :466:35, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [31:0] _dram_offset_T_19 = _GEN_4 * _GEN_3;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:455:42, :466:35]
  wire [31:0] _GEN_5 = {16'h0, req_outer_bounds_in_channels};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :466:46, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [31:0] _GEN_6 = {16'h0, kcol};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:462:17, :466:66, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [31:0] _GEN_7 = {16'h0, kch};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:463:16, :466:79, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [31:0] _GEN_8 = {16'h0, och};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:460:16, :466:103, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [31:0] _GEN_9 = {16'h0, req_outer_bounds_out_channels};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :468:87, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [31:0] _GEN_10 = {16'h0, req_inner_bounds_krows};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :475:55, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [47:0] _GEN_11 = {32'h0, req_inner_bounds_kcols};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :449:72, :475:63]
  wire [47:0] _GEN_12 = {16'h0, _GEN_4 * _GEN};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:449:64, :466:35, :475:{85,93}, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [15:0] _K_T_9 = req_inner_bounds_kchs - kch;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :463:16, :480:14]
  wire [15:0] _K_T_3 = req_derived_params_ochs - och;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :460:16, :481:14]
  wire        _io_idle_T = state == 2'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :497:14, :519:25]
  wire        _io_req_ready_output = _io_idle_T & ~_command_p_io_busy;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25, :519:{25,34,37}]
  wire        _command_p_io_in_valid_T_4 = (|state) & ~io_wait_for_prev_loop & (|req_dram_addr);	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :437:16, :523:{34,46,69,87}]
  wire        _command_p_io_in_bits_cmd_T = state == 2'h1;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :505:27, :524:41]
  wire        _GEN_13 = _command_p_io_out_bits_cmd_inst_funct == 7'h1;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25, :514:23, :533:46]
  wire        _GEN_14 = req_dram_addr == 34'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :466:79, :545:22]
  wire        _GEN_15 = _command_p_io_in_ready & _command_p_io_in_valid_T_4;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25, :523:69, src/main/scala/chisel3/util/Decoupled.scala:52:35]
  wire [16:0] _next_kch_T_3 = {1'h0, kch} + {1'h0, req_trans_weight_0132 ? max_chs_per_mvin_max_kchs_per_mvin : 16'h8};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :437:16, :445:32, :463:16, :475:23, :480:14, :552:23, generators/gemmini/src/main/scala/gemmini/Util.scala:41:15]
  wire        _next_kch_T_4 = _next_kch_T_3 > {1'h0, req_inner_bounds_kchs - 16'h1};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :437:16, generators/gemmini/src/main/scala/gemmini/Util.scala:39:28, :41:15, :43:17]
  wire [15:0] next_kch = _next_kch_T_4 ? 16'h0 : _next_kch_T_3[15:0];	// @[generators/gemmini/src/main/scala/gemmini/Util.scala:41:15, :43:17, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [16:0] _next_kcol_T_4 = {1'h0, kcol} + 17'h1;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :462:17, generators/gemmini/src/main/scala/gemmini/Util.scala:39:28, :41:15]
  wire        _next_kcol_T_5 = _next_kcol_T_4 > {1'h0, req_inner_bounds_kcols - 16'h1};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :437:16, generators/gemmini/src/main/scala/gemmini/Util.scala:39:28, :41:15, :43:17]
  wire        _state_T_3 = ((|next_kch) ? kcol : _next_kcol_T_5 ? 16'h0 : _next_kcol_T_4[15:0]) == 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:462:17, :555:59, :556:60, generators/gemmini/src/main/scala/gemmini/Util.scala:41:15, :43:17, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire        _next_krow_T_2 = _state_T_3 & ~(|next_kch);	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:555:59, :556:{60,68}, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [16:0] _next_krow_T_6 = {1'h0, krow} + 17'h1;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :461:17, generators/gemmini/src/main/scala/gemmini/Util.scala:39:28, :41:15]
  wire        _next_krow_T_7 = _next_krow_T_6 > {1'h0, req_inner_bounds_krows - 16'h1};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :437:16, generators/gemmini/src/main/scala/gemmini/Util.scala:39:28, :41:15, :43:17]
  wire        _state_T_1 = (_next_krow_T_2 ? (_next_krow_T_7 ? 16'h0 : _next_krow_T_6[15:0]) : krow) == 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:461:17, :556:68, :557:60, generators/gemmini/src/main/scala/gemmini/Util.scala:41:15, :43:17, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire        _next_och_T_4 = _state_T_1 & _state_T_3 & ~(|next_kch);	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:555:59, :556:60, :557:{60,89}, src/main/scala/chisel3/util/Mux.scala:141:16]
  wire [16:0] _next_och_T_8 = {1'h0, och} + {1'h0, req_trans_weight_0132 ? 16'h8 : max_chs_per_mvin_max_ochs_per_mvin};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :437:16, :444:32, :460:16, :475:23, :481:14, :551:23, generators/gemmini/src/main/scala/gemmini/Util.scala:41:15]
  wire        _next_och_T_9 = _next_och_T_8 > {1'h0, req_derived_params_ochs - 16'h1};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :437:16, generators/gemmini/src/main/scala/gemmini/Util.scala:39:28, :41:15, :43:17]
  wire        _GEN_16 = _io_req_ready_output & io_req_valid;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:519:34, src/main/scala/chisel3/util/Decoupled.scala:52:35]
  always @(posedge clock) begin
    if (reset)
      state <= 2'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :497:14]
    else if (_GEN_16)	// @[src/main/scala/chisel3/util/Decoupled.scala:52:35]
      state <= 2'h1;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :505:27]
    else if (_GEN_14)	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:545:22]
      state <= 2'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :497:14]
    else if (_GEN_15) begin	// @[src/main/scala/chisel3/util/Decoupled.scala:52:35]
      if (_command_p_io_in_bits_cmd_T)	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:524:41]
        state <= 2'h2;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :549:13]
      else	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:524:41]
        state <= {~((_next_och_T_4 ? (_next_och_T_9 ? 16'h0 : _next_och_T_8[15:0]) : och) == 16'h0 & _state_T_1 & _state_T_3 & ~(|next_kch)), 1'h0};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :460:16, :555:59, :556:60, :557:{60,89}, :564:{19,29,79}, generators/gemmini/src/main/scala/gemmini/Util.scala:41:15, :43:17, src/main/scala/chisel3/util/Mux.scala:141:16]
    end
    if (_GEN_16) begin	// @[src/main/scala/chisel3/util/Decoupled.scala:52:35]
      req_outer_bounds_in_channels <= io_req_bits_outer_bounds_in_channels;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_outer_bounds_out_channels <= io_req_bits_outer_bounds_out_channels;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_outer_bounds_weight_stride <= io_req_bits_outer_bounds_weight_stride;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_outer_bounds_kernel_dim <= io_req_bits_outer_bounds_kernel_dim;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_inner_bounds_krows <= io_req_bits_inner_bounds_krows;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_inner_bounds_kcols <= io_req_bits_inner_bounds_kcols;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_inner_bounds_kchs <= io_req_bits_inner_bounds_kchs;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_derived_params_ochs <= io_req_bits_derived_params_ochs;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_derived_params_out_channels_per_bank <= io_req_bits_derived_params_out_channels_per_bank;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_derived_params_in_channels_per_bank <= io_req_bits_derived_params_in_channels_per_bank;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_derived_params_weight_spad_stride <= io_req_bits_derived_params_weight_spad_stride;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_addr_end <= io_req_bits_addr_end;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_dram_addr <= io_req_bits_dram_addr;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_trans_weight_1203 <= io_req_bits_trans_weight_1203;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_trans_weight_0132 <= io_req_bits_trans_weight_0132;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_dw <= io_req_bits_dw;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      req_loop_id <= io_req_bits_loop_id;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
      och <= 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:460:16, src/main/scala/chisel3/util/Mux.scala:141:16]
      krow <= 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:461:17, src/main/scala/chisel3/util/Mux.scala:141:16]
      kcol <= 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:462:17, src/main/scala/chisel3/util/Mux.scala:141:16]
      kch <= 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:463:16, src/main/scala/chisel3/util/Mux.scala:141:16]
    end
    else begin	// @[src/main/scala/chisel3/util/Decoupled.scala:52:35]
      if (_GEN_14 | ~_GEN_15 | _command_p_io_in_bits_cmd_T | ~_next_och_T_4) begin	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:460:16, :463:16, :524:41, :545:{22,30}, :547:36, :548:29, :557:89, generators/gemmini/src/main/scala/gemmini/Util.scala:42:8, src/main/scala/chisel3/util/Decoupled.scala:52:35]
      end
      else if (_next_och_T_9)	// @[generators/gemmini/src/main/scala/gemmini/Util.scala:43:17]
        och <= 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:460:16, src/main/scala/chisel3/util/Mux.scala:141:16]
      else	// @[generators/gemmini/src/main/scala/gemmini/Util.scala:43:17]
        och <= _next_och_T_8[15:0];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:460:16, generators/gemmini/src/main/scala/gemmini/Util.scala:41:15]
      if (_GEN_14 | ~_GEN_15 | _command_p_io_in_bits_cmd_T | ~_next_krow_T_2) begin	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:461:17, :463:16, :524:41, :545:{22,30}, :547:36, :548:29, :556:68, generators/gemmini/src/main/scala/gemmini/Util.scala:42:8, src/main/scala/chisel3/util/Decoupled.scala:52:35]
      end
      else if (_next_krow_T_7)	// @[generators/gemmini/src/main/scala/gemmini/Util.scala:43:17]
        krow <= 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:461:17, src/main/scala/chisel3/util/Mux.scala:141:16]
      else	// @[generators/gemmini/src/main/scala/gemmini/Util.scala:43:17]
        krow <= _next_krow_T_6[15:0];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:461:17, generators/gemmini/src/main/scala/gemmini/Util.scala:41:15]
      if (_GEN_14 | ~_GEN_15 | _command_p_io_in_bits_cmd_T | (|next_kch)) begin	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:462:17, :463:16, :524:41, :545:{22,30}, :547:36, :548:29, :555:59, src/main/scala/chisel3/util/Decoupled.scala:52:35, src/main/scala/chisel3/util/Mux.scala:141:16]
      end
      else if (_next_kcol_T_5)	// @[generators/gemmini/src/main/scala/gemmini/Util.scala:43:17]
        kcol <= 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:462:17, src/main/scala/chisel3/util/Mux.scala:141:16]
      else	// @[generators/gemmini/src/main/scala/gemmini/Util.scala:43:17]
        kcol <= _next_kcol_T_4[15:0];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:462:17, generators/gemmini/src/main/scala/gemmini/Util.scala:41:15]
      if (_GEN_14 | ~_GEN_15 | _command_p_io_in_bits_cmd_T) begin	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:463:16, :524:41, :545:{22,30}, :547:36, :548:29, src/main/scala/chisel3/util/Decoupled.scala:52:35]
      end
      else if (_next_kch_T_4)	// @[generators/gemmini/src/main/scala/gemmini/Util.scala:43:17]
        kch <= 16'h0;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:463:16, src/main/scala/chisel3/util/Mux.scala:141:16]
      else	// @[generators/gemmini/src/main/scala/gemmini/Util.scala:43:17]
        kch <= _next_kch_T_3[15:0];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:463:16, generators/gemmini/src/main/scala/gemmini/Util.scala:41:15]
    end
  end // always @(posedge)
  `ifdef ENABLE_INITIAL_REG_
    `ifdef FIRRTL_BEFORE_INITIAL
      `FIRRTL_BEFORE_INITIAL
    `endif // FIRRTL_BEFORE_INITIAL
    logic [31:0] _RANDOM[0:27];
    initial begin
      `ifdef INIT_RANDOM_PROLOG_
        `INIT_RANDOM_PROLOG_
      `endif // INIT_RANDOM_PROLOG_
      `ifdef RANDOMIZE_REG_INIT
        for (logic [4:0] i = 5'h0; i < 5'h1C; i += 5'h1) begin
          _RANDOM[i] = `RANDOM;
        end
        state = _RANDOM[5'h0][1:0];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22]
        req_outer_bounds_in_channels = {_RANDOM[5'h1][31:18], _RANDOM[5'h2][1:0]};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_outer_bounds_out_channels = _RANDOM[5'h2][17:2];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_outer_bounds_weight_stride = {_RANDOM[5'h4][31:18], _RANDOM[5'h5][1:0]};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_outer_bounds_kernel_dim = _RANDOM[5'h7][17:2];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_inner_bounds_krows = {_RANDOM[5'hB][31:18], _RANDOM[5'hC][1:0]};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_inner_bounds_kcols = _RANDOM[5'hC][17:2];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_inner_bounds_kchs = {_RANDOM[5'hC][31:18], _RANDOM[5'hD][1:0]};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_derived_params_ochs = _RANDOM[5'h12][17:2];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_derived_params_out_channels_per_bank = _RANDOM[5'h15][17:2];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_derived_params_in_channels_per_bank = {_RANDOM[5'h15][31:18], _RANDOM[5'h16][1:0]};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_derived_params_weight_spad_stride = _RANDOM[5'h17][17:2];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_addr_end = _RANDOM[5'h17][31:18];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_dram_addr = {_RANDOM[5'h18], _RANDOM[5'h19][1:0]};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_trans_weight_1203 = _RANDOM[5'h19][2];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_trans_weight_0132 = _RANDOM[5'h19][3];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_dw = _RANDOM[5'h19][4];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        req_loop_id = _RANDOM[5'h19][5];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
        och = _RANDOM[5'h19][21:6];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :460:16]
        krow = {_RANDOM[5'h19][31:22], _RANDOM[5'h1A][5:0]};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :461:17]
        kcol = _RANDOM[5'h1A][21:6];	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:461:17, :462:17]
        kch = {_RANDOM[5'h1A][31:22], _RANDOM[5'h1B][5:0]};	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:461:17, :463:16]
      `endif // RANDOMIZE_REG_INIT
    end // initial
    `ifdef FIRRTL_AFTER_INITIAL
      `FIRRTL_AFTER_INITIAL
    `endif // FIRRTL_AFTER_INITIAL
  `endif // ENABLE_INITIAL_REG_
  Pipeline_12 command_p (	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
    .clock                      (clock),
    .reset                      (reset),
    .io_in_ready                (_command_p_io_in_ready),
    .io_in_valid                (_command_p_io_in_valid_T_4),	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:523:69]
    .io_in_bits_cmd_inst_funct  ({6'h0, ~_command_p_io_in_bits_cmd_T}),	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:524:{34,41}]
    .io_in_bits_cmd_rs1         (_command_p_io_in_bits_cmd_T ? {35'h1FC000000, req_derived_params_weight_spad_stride[12:0], 16'h109} : 64'h0),	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :503:25, :508:36, :515:16, :524:{34,41}]
    .io_in_bits_cmd_rs2         (_command_p_io_in_bits_cmd_T ? {16'h0, req_dw ? 48'h1 : req_trans_weight_1203 ? {16'h0, _GEN_3 * _GEN_3} * {32'h0, req_outer_bounds_out_channels} : {32'h0, req_trans_weight_0132 ? req_outer_bounds_in_channels : req_outer_bounds_weight_stride}} : 64'h0),	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :449:72, :455:{42,55}, :510:18, :515:16, :524:{34,41}, src/main/scala/chisel3/util/Mux.scala:141:16]
    .io_in_bits_dram_addr       ({33'h0, {3'h0, req_dw ? _dram_offset_T_19 + _GEN_6 : req_trans_weight_1203 ? (_GEN_7 * _GEN_3 * _GEN_3 + _dram_offset_T_19 + _GEN_6) * _GEN_9 + _GEN_8 : req_trans_weight_0132 ? (_dram_offset_T_19 * _GEN_9 + _GEN_6 * _GEN_9 + _GEN_8) * _GEN_5 + _GEN_7 : (_dram_offset_T_19 * _GEN_5 + _GEN_6 * _GEN_5 + _GEN_7) * {16'h0, req_outer_bounds_weight_stride} + _GEN_8} + {1'h0, req_dram_addr}}),	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:435:22, :437:16, :455:42, :466:{35,46,66,79,87,103}, :467:{34,43}, :468:{47,78,87,102}, :469:{48,69,83,91,105}, :471:33, :1556:17, src/main/scala/chisel3/util/Mux.scala:141:16]
    .io_in_bits_spad_addr       (req_trans_weight_0132 ? _addr_start_T + {16'h0, {16'h0, {16'h0, kch / 16'h8} * _GEN_10} * _GEN_11} * _GEN_1 + {16'h0, _GEN_12 * {32'h0, req_derived_params_ochs}} + {32'h0, _GEN_6 * {16'h0, req_derived_params_ochs}} + {48'h0, och} : _addr_start_T + {16'h0, {16'h0, {16'h0, och / 16'h8} * _GEN_10} * _GEN_11} * _GEN_2 + {16'h0, _GEN_12 * {32'h0, req_inner_bounds_kchs}} + {32'h0, _GEN_6 * {16'h0, req_inner_bounds_kchs}} + {48'h0, kch}),	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :449:{72,80}, :450:43, :451:33, :460:16, :463:16, :466:66, :473:22, :475:{23,55,63,71,78,93,100,107,114}, :476:{23,55,63,71,78,93,100,107,114}, src/main/scala/chisel3/util/Mux.scala:141:16]
    .io_in_bits_K               (req_trans_weight_0132 ? (_K_T_3 > 16'h8 ? 16'h8 : _K_T_3) : _K_T_9 > 16'h8 ? 16'h8 : _K_T_9),	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :475:23, :480:14, :481:14, :482:14, :483:{8,20}, :484:{8,20}]
    .io_in_bits_J               (req_trans_weight_0132 ? (_K_T_9 > max_chs_per_mvin ? max_chs_per_mvin_max_kchs_per_mvin : _K_T_9) : _K_T_3 > max_chs_per_mvin ? max_chs_per_mvin_max_ochs_per_mvin : _K_T_3),	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16, :444:32, :445:32, :446:8, :479:14, :480:{8,14,20}, :481:{8,14,20}]
    .io_out_ready               (io_cmd_ready & ~io_rob_overloaded),	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:530:{42,45}]
    .io_out_valid               (_command_p_io_out_valid),
    .io_out_bits_cmd_inst_funct (_command_p_io_out_bits_cmd_inst_funct),
    .io_out_bits_cmd_rs1        (_command_p_io_out_bits_cmd_rs1),
    .io_out_bits_cmd_rs2        (_command_p_io_out_bits_cmd_rs2),
    .io_out_bits_dram_addr      (_command_p_io_out_bits_dram_addr),
    .io_out_bits_spad_addr      (_command_p_io_out_bits_spad_addr),
    .io_out_bits_K              (_command_p_io_out_bits_K),
    .io_out_bits_J              (_command_p_io_out_bits_J),
    .io_busy                    (_command_p_io_busy)
  );
  assign io_req_ready = _io_req_ready_output;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:519:34]
  assign io_cmd_valid = _command_p_io_out_valid & ~io_rob_overloaded;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25, :530:45, :531:42]
  assign io_cmd_bits_inst_funct = _command_p_io_out_bits_cmd_inst_funct;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25]
  assign io_cmd_bits_rs1 = _GEN_13 ? _command_p_io_out_bits_dram_addr[63:0] : _command_p_io_out_bits_cmd_rs1;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25, :532:15, :533:{46,61}, :535:21]
  assign io_cmd_bits_rs2 = _GEN_13 ? {12'h0, _command_p_io_out_bits_K[3:0], 9'h0, _command_p_io_out_bits_J[6:0], 3'h0, _command_p_io_out_bits_spad_addr[28:26], 12'h0, _command_p_io_out_bits_spad_addr[13:0]} : _command_p_io_out_bits_cmd_rs2;	// @[generators/gemmini/src/main/scala/gemmini/LocalAddr.scala:108:37, generators/gemmini/src/main/scala/gemmini/LoopConv.scala:471:33, :493:25, :532:15, :533:{46,61}, :537:18, :538:27, :539:27, :541:{21,37}, :1556:17]
  assign io_idle = _io_idle_T & ~_command_p_io_busy;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:493:25, :519:{25,37}, :520:29]
  assign io_loop_id = req_loop_id;	// @[generators/gemmini/src/main/scala/gemmini/LoopConv.scala:437:16]
endmodule

